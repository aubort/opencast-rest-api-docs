<!DOCTYPE html>
<html>
<head>
  <title>${meta.title} REST Documentation</title>

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">

  <!-- Optional theme -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">

  <!-- <link rel="stylesheet" href="main.css"> -->

  <style>
  html, body {
    font-family: "Open Sans",Helvetica,sans-serif;
    font-size: 16px;
    width:100%;
    color: #474a54;
  }
  .main-content {
    max-width:950px;
    margin-top:30px;
    margin-left: auto;
    margin-right: auto;
  }

  h1 {
    font-size: 150%;
    font-weight: 100;
    color: #444;
    line-height: 24px;
    margin-top: 40px;
  }
  h2 {
    font-size: 125%;
    font-weight: 400;
  }

  hr {
    margin-bottom: 18px;
    border: 0;
    border-top: 1px solid #eeeeee;
  }

  p {
      line-height: 20px;
      margin: 0;
      margin-bottom: 15px;
  }

  ul, li {
      line-height: 24px;
      list-style: disc;
      font-weight: 400;
  }

  a{
      color: #3367d6 !important;
      text-decoration: none !important;
  }

  table {
    border-collapse: collapse;
    border-spacing: 1px;
    width:100%;
    margin-bottom:20px;
  }

  table tr, td, th, tbody{
    padding: 6px 10px;
    border: 1px solid #DDDDDD;
    text-align: left;
  }

  table th{
    background-color: #6199DF;
    color: white !important;
    border-color: #6199DF;
  }

  table th:nth-child(1){
       width:200px;
  }

  table code {
    border: 0px;
    background-color: transparent;
    padding: 0px;
    margin: 0px;
  }

  code {
    white-space: pre;
    padding: 0px 3px 0px 3px;
    color: #007000;
    font-size: 90%;
    border: 1px solid;
    border-color: #E8E8E8;
    border-radius: 3px;
    background-color: #F7F4F4;
    font-family: Consolas,"Andale Mono WT","Andale Mono","Lucida Console","Lucida Sans Typewriter","DejaVu Sans Mono","Bitstream Vera Sans Mono","Liberation Mono","Nimbus Mono L",Monaco,"Courier New",Courier,monospace
  }

  code .status{
    text-transform: uppercase;
  }

  code.code-block, pre{
    display: block;
    padding: 8px 5px 5px 10px;
    width: 100%;
    overflow: auto;
    max-height: 300px;
  }

  .e-type {
    color: #fff;
    font-size: 70%;
    text-shadow: 0 -1px 0 rgba(0,0,0,0.25);
    border-color: transparent;
  }

  .t-GET{
    background-color: #10a54a;
  }

  .t-POST{
    background-color: #0f6ab4;
  }

  .t-PUT{
    background-color: #c5862b;
  }

  .t-DELETE{
    background-color: #a41e22;
  }

  .required:after{
    content:'\002A';
    color: red;
  }

  .panel-default>.panel-heading{
    background-image: none !important;
    background-color: transparent !important;
    border: 0px !important;
  }

  .panel {
    /*border:0px;*/

  }


  pre {outline: 1px solid #ccc; padding: 5px; margin: 5px; }
  .string { color: green; }
  .number { color: darkorange; }
  .boolean { color: blue; }
  .null { color: magenta; }
  .key { color: red; }
  </style>

</head>

<body>


<!--  SAMPLE TABLE    -->
<!--
      <table>
            <thead>
            <tr>
                <th align="left">Parameter</th>
                <th align="left">Type</th>
                <th align="left">Description</th>
            </tr>
            </thead>
            <tbody>
                <tr>
                    <td align="left"><code>sign</code></td>
                    <td align="left">boolean</td>
                    <td align="left">Whether public distribution urls should be signed.</td>
                </tr>
                <tr>
                    <td align="left"><code>sign</code></td>
                    <td align="left">boolean</td>
                    <td align="left">Whether public distribution urls should be signed.</td>
                </tr>
            </tbody>
        </table>
-->
<!-- END SAMPLE TALBE     -->

<!-- Sample list -->
<!-- <ul>
    <li><a href="#get-apievents">GET /api/events</a></li>
    <li><a href="#post-apievents">POST /api/events</a></li>
    <li><a href="#get-apieventevent_id">GET /api/event/{event_id}</a></li>
    <li><a href="#put-apieventsevent_id">PUT /api/events/{event_id}</a></li>
    <li><a href="#delete-apieventsevent_id">DELETE /api/events/{event_id}</a></li>
</ul> -->





<section class="main-content">

  <!--FORM SAMPLE -->





  <div class="panel panel-default">
    <div class="panel-heading" role="tab" id="form-heading00">
      <h4 class="panel-title">Try it out
        <a class="" data-toggle="collapse" href="#form-collapse00" aria-expanded="true" aria-controls="form-collapse00">
          [show / hide]
        </a>
      </h4>
    </div>
    <div id="form-collapse00" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="form-heading00" aria-expanded="true">
      <div class="panel-body">
          <form id="form_00" class="form-horizontal" action="/admin-ng/event/{eventId}/comment/{commentId}" method="post" data-id="00">
            <!-- <input class="form_action_holder" type="hidden" value="/admin-ng/event/{eventId}/comment" />
            <input class="form_endpoint_name" type="hidden" value="createeventcomment" />
            <input class="form_method" type="hidden" value="POST" /> -->
            <!-- <input class="form_ajax_submit" type="hidden" value="1" /> -->
            <!--
            <div class="spaced">
                <strong>Form action:</strong> <tt class="form_path">/admin-ng/event/{eventId}/comment</tt>
            </div>
          -->

                <div class="form-group form-group-sm">
                  <label for="createeventcomment_eventId_00" class="col-sm-2 control-label">eventId_00_00_00</label>
                  <div class="col-sm-10">
                    <input type="text" name="eventId_00" class="form-control" id="createeventcomment_eventId_00" value="123">
                  </div>
                </div>
                <div class="form-group form-group-sm">
                  <label for="createeventcomment_text_00" class="col-sm-2 control-label">text</label>
                  <div class="col-sm-10">
                    <textarea name="createeventcomment_text_00" class="form-control" id="createeventcomment_text_00"></textarea>
                  </div>
                </div>
                <div class="form-group form-group-sm">
                  <label for="createeventcomment_resolved_00" class="col-sm-2 control-label">resolved</label>
                  <div class="col-sm-10">
                    <div class="checkbox">
                      <label>
                        <input type="checkbox" name="resolved" id="createeventcomment_resolved_00" value="true">
                      </label>
                    </div>
                  </div>
                </div>
                <div class="form-group form-group-sm">
                  <label for="createeventcomment_reason_00" class="col-sm-2 control-label">reason</label>
                  <div class="col-sm-10">
                    <input type="text" name="reason" class="form-control" id="createeventcomment_reason_00" value="reason">
                  </div>
                </div>
                <div class="form-group form-group-sm">
                  <label for="createeventcomment_commentId_00" class="col-sm-2 control-label">commentId</label>
                  <div class="col-sm-10">
                    <input type="text" name="commentId_00" class="form-control" id="createeventcomment_eventId" value="bla">
                  </div>
                </div>
            <button type="button" class="btn btn-default">Cancel</button>
            <button type="submit" class="btn btn-primary">Submit</button>
          </form>
          <p>
            <pre id="form_response_block_00" class="collapse">bla</pre>
          </p>
      </div>
    </div>
  </div>


    <#assign c=0>
    <#list endpointHolders as endpointHolder>
      <#if (endpointHolder.endpoints?size > 0)>
        <!--   TOC     -->
        <ul>
            <#list endpointHolder.endpoints as endpoint>
              <li><a href="#${endpoint.method}-${meta.url}${endpoint.path}">${endpoint.method} ${meta.url}${endpoint.path}</a></li>
            </#list>
        </ul>

        <#list endpointHolder.endpoints as endpoint>

        <span>Count: ${c}</span>
        <!-- title and description -->
            <h1 id="${endpoint.method}-${meta.url}${endpoint.path}">
              <code class="e-type t-${endpoint.method}">${endpoint.method}</code>
              ${meta.url}${endpoint.path}
            </h1>
            <hr />
            <p>${endpoint.description!"&nbsp;"}</p>
            <#if (endpoint.pathParams?size > 0)>
            <!-- Table listing all the Path Params -->
                <table>
                    <thead>
                        <tr>
                            <th>Path Parameter(s)</th>
                            <!-- <th>Type</th> -->
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <#list endpoint.pathParams as param>
                            <tr>
                                <td align="left"><code>${param.name}</code></td>
                                <!-- <td align="left"></td> -->
                                <td align="left">
                                  ${param.description!"&nbsp;"}
                                  <#if param.defaultValue??><br />Default value=${param.escapedDefaultValue}</#if>
                                </td>
                            </tr>
                        </#list> <!-- endpoint.pathParams as param -->
                    </tbody>
                </table>
            </#if> <!-- endpoint.pathParams -->

            <!-- Form Params table header -->

            <#if (endpoint.requiredParams?size > 0) || (endpoint.optionalParams?size > 0)>
              <table>
                <thead>
                    <tr>
                        <th>Form Parameter(s)</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
            </#if>
            <!-- Form Params required -->
            <#if (endpoint.requiredParams?size > 0)>
              <#list endpoint.requiredParams as param>
                <tr>
                    <td align="left"><code class="required">${param.name}</code></td>
                    <td align="left"><code>${param.type!"&nbsp;"}</code></td>
                    <!-- <td align="left"></td> -->
                    <td align="left">
                      ${param.description!"&nbsp;"}
                      <#if param.defaultValue??><br />Default value=${param.escapedDefaultValue}</#if>
                    </td>
                </tr>
              </#list> <!-- endpoint.requiredParams as param -->
            </#if>
            <#if (endpoint.optionalParams?size > 0)>
              <#list endpoint.optionalParams as param>
                <tr>
                    <td align="left"><code>${param.name}</code></td>
                    <td align="left"><code>${param.type!"&nbsp;"}</code></td>
                    <td align="left">
                      ${param.description!"&nbsp;"}
                      <#if param.defaultValue??><br />Default value=${param.escapedDefaultValue}</#if>
                    </td>
                </tr>
              </#list>
            </#if> <!-- (endpoint.optionalParams?size > 0) -->
                  </tbody>
              </table>

            <#if endpoint.bodyParam??>
              <table>
                <thead>
                    <tr>
                        <!-- <th>Parameter</th> -->
                        <!-- <th>Type</th> -->
                        <th>Body Parameter(s) - Upload</th>
                    </tr>
                </thead>
                <tbody>
                  <tr>
                      <!-- <td align="left"><code></code></td> -->
                      <!-- <td align="left"></td> -->
                      <td align="left">
                        ${endpoint.bodyParam.description!"&nbsp;"}
                        <#if endpoint.bodyParam.defaultValue??><br />Default value=${param.escapedDefaultValue}</#if>
                      </td>
                  </tr>
                </tbody>
              </table>
            </#if> <!-- endpoint.bodyParam?? -->

            <h2>Response</h2>
              <!-- Response formats -->
              <#if (endpoint.formats?size > 0)>
              <p>
                Response format(s):
                <#list endpoint.formats as format>
                  <#if format.url??>
                    <a href="${format.url}" target="_blank">${format.name}</a>
                  <#else>
                    ${format.name}
                  </#if>
                  <#if format.description??>
                    (${format.description})
                  </#if>
                  <#if format_has_next>
                    &#44; &nbsp;
                  </#if>
                </#list>
              </p>
              </#if>

              <!-- Status Codes -->
              <#if (endpoint.statuses?size > 0)>
                <p>
                  <#list endpoint.statuses as status>
                    <code class="status">${status.code} &#40;${status.name}&#41;</code> ${status.description!"&nbps;"}<#if status_has_next> <br/></#if>
                  </#list>
                </p>
              </#if>

              <!-- Return Type Schema -->
              <#if (endpoint.returnTypeSchema??)>
                <div class="panel panel-default">
                  <div class="panel-heading" role="tab" id="schema-heading${c}">
                    <h4 class="panel-title">Return Type Schema
                      <a class="collapsed" data-toggle="collapse" href="#schema-collapse${c}" aria-expanded="false" aria-controls="schema-collapse${c}">
                        [show / hide]
                      </a>
                    </h4>
                  </div>
                  <div id="schema-collapse${c}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="schema-heading${c}">
                    <div class="panel-body">
                      <code class="code-block">${endpoint.escapedReturnTypeSchema}</code>
                    </div>
                  </div>
                </div>
              </#if> <!-- (endpoint.returnTypeSchema??) -->

              <!-- Endpoint notes -->
              <#if (endpoint.notes?size > 0)>
              <h2>Notes</h2>
              <ul>
                <#list endpoint.notes as note>
                <li>${note}</li>
                </#list>
              </ul>
              </#if> <!-- endpoint.notes?size > 0 -->


              <!-- Testing form -->
              <#if endpoint.form??>
                <div class="panel panel-default">
                  <div class="panel-heading" role="tab" id="form-heading${c}">
                    <h4 class="panel-title">Try it out
                      <a class="collapsed" data-toggle="collapse" href="#form-collapse${c}" aria-expanded="false" aria-controls="form-collapse${c}">
                        [show / hide]
                      </a>
                    </h4>
                  </div>
                  <div id="form-collapse${c}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="form-heading${c}">
                    <div class="panel-body">
                        <form id="form_${c}" class="form-horizontal" action="${meta.url}${endpoint.path}"
                              method="${endpoint.method?lower_case}" data-id="${c}">
                          <!-- <input class="form_action_holder" type="hidden" value="${meta.url}${endpoint.path}" />
                          <input class="form_endpoint_name" type="hidden" value="${endpoint.name}" />
                          <input class="form_method" type="hidden" value="${endpoint.method}" /> -->
                          <#if (endpoint.form.ajaxSubmit)>
                          <!-- <input class="form_ajax_submit" type="hidden" value="1" /> -->
                          </#if>
                          <!--
                          <div class="spaced">
                              <strong>Form action:</strong> <tt class="form_path">${meta.url}${endpoint.path}</tt>
                          </div>
                        -->

                          <#list endpoint.form.items as item>
                            <#if item.type == "text">
                              <div class="form-group form-group-sm">
                                <label for="${endpoint.name}_${item.name}" class="col-sm-2 control-label">${item.name}</label>
                                <div class="col-sm-10">
                                  <textarea name="${item.name}" class="form-control" id="${endpoint.name}_${item.name}">${item.defaultValue!}</textarea>
                                </div>
                              </div>
                            <#elseif item.type == "boolean">
                              <div class="form-group form-group-sm">
                                <label for="${endpoint.name}_${item.name}" class="col-sm-2 control-label">${item.name}</label>
                                <div class="col-sm-10">
                                  <div class="checkbox">
                                    <label>
                                      <input type="checkbox" name="${item.name}" id="${endpoint.name}_${item.name}" value="true">
                                    </label>
                                  </div>
                                </div>
                              </div>
                            <#elseif item.type == "file">
                              <div class="form-group form-group-sm">
                                <label for="${endpoint.name}_${item.name}" class="col-sm-2 control-label">${item.name}</label>
                                <div class="col-sm-10">
                                  <input type="file" name="${item.name}" class="form-control" id="${endpoint.name}_${item.name}">
                                </div>
                              </div>
                            <#else>
                              <div class="form-group form-group-sm">
                                <label for="${endpoint.name}_${item.name}" class="col-sm-2 control-label">${item.name}</label>
                                <div class="col-sm-10">
                                  <input type="text" name="${item.name}" class="form-control" id="${endpoint.name}_${item.name}" value="${item.defaultValue!}">
                                </div>
                              </div>
                            </#if>
                          </#list>
                          <button type="button" class="btn btn-default">Cancel</button>
                          <button type="submit" class="btn btn-primary">Submit</button>
                        </form>
                        <p>
                        <pre id="form_response_block_${c}" class="collapse"></pre>
                      </p>
                    </div>
                  </div>
                </div>
              </#if> <!-- endpoint.form??  -->


              <!--  -->
              <div class="panel panel-default">
                <div class="panel-heading" role="tab" id="debug-heading${c}">
                  <h4 class="panel-title">DEBUG
                    <a class="collapsed" data-toggle="collapse" href="#debug-collapse${c}" aria-expanded="false" aria-controls="debug-collapse${c}">
                      [show / hide]
                    </a>
                  </h4>
                </div>
                <div id="debug-collapse${c}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="debug-heading${c}">
                  <div class="panel-body">
                    <code class="code-block">${endpoint}</code>
                  </div>
                </div>
              </div>

          <#assign c = c + 1>
        </#list>
      </#if>
    </#list> <!-- endpointHolders as endpointHolder -->

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>

    <script>

    $(function () {
      $('form').on('submit', function (e) {

          var params = $(this).serializeArray();
          var id = $(this).attr('data-id');
          console.log("id:" + id);


          for(param in params){
            console.log(params[param]);
          }

          var path = $(this).attr('action');
          var method = $(this).attr('method');

          var url = replacePathParams(path, params);
          var formParams = getParams(params);

          $( "#form_response_block_"+id ).attr("class", "expand");

          $.ajax({
            type: method,
            url: url,
            processData: true,
            dataType: 'text',
            data: formParams,
            success: function (response, textStatus, request) {
                console.log("Status:" + textStatus);
                console.log("Request:" + request);

                var responseString;
                try {
                    responseString = JSON.stringify(JSON.parse(response), null, 2);
                } catch(e) {
                    responseString = response
                }



                $( "#form_response_block_"+id ).html(syntaxHighlight(responseString));

            },
            error: function(data, textStatus, request){
              $( "#form_response_block_"+id ).text(textStatus);
              //console.log("failed: " + request);
            }
          });
          e.preventDefault();
      });
    });

    /*
    * This removes the path params from the serialized from data
    */
    function getParams(params){

      for(var i = 0; i < params.length; i++){
        // console.log(params[i]);
        if (params.hasOwnProperty(i)){
          params.splice(i, 1);
        }
      }
      return params;
    }

    /*
    * Replace the vars in the curly braces by the values sent using the form
    * Returns the form action url
    *
    */
    function replacePathParams(path, params){

      for(var i = 0; i < params.length; i++){
        path = path.replace(new RegExp('{' + params[i]['name'] + '}', 'gi'), params[i]['value'])
      }

      return path;
    }


    /*
    * Highlights Json syntax
    */
    function syntaxHighlight(json) {
      json = json.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
      return json.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g, function (match) {
          var cls = 'number';
          if (/^"/.test(match)) {
              if (/:$/.test(match)) {
                  cls = 'key';
              } else {
                  cls = 'string';
              }
          } else if (/true|false/.test(match)) {
              cls = 'boolean';
          } else if (/null/.test(match)) {
              cls = 'null';
          }
          return '<span class="' + cls + '">' + match + '</span>';
      });
    }


    </script>


  </section>
  </body>
</html>
